
### 文件的逻辑结构

文件的逻辑结构：指一个文件在用户面前所呈现的形式，又称文件组织
#### 无结构文件

文件内部的数据由二进制或字符流组成，又称“流式文件”(如文本文件)
#### 有结构文件

由一组相似的记录组成，又称“记录式文件”(如数据库表)，有结构文件根据用户和系统管理的需要，有顺序、索引、索引顺序方式组织这些记录
##### 顺序文件

文件中的记录一个接一个地顺序排列(逻辑上)，记录可以是定长的或可变长的，各个记录在物理上可以顺序存储或链式存储

- 链式存储
无论是定长/可变长记录，都无法实现随机存取，每次只能从第一个记录开始依次往后查找
- 顺序存储
可变长记录：无法实现随机存取，每次只能从第一个记录开始依次往后查找
定长记录：可现随机存取；
若采用串结构，无法快速找到某关键字对应的记录
若采用顺序结构，可以快速找到某关键字对应的记录
##### 索引文件

索引表本身是定长记录的顺序文件；可以快速找到第i个记录对应的索引项，可将关键字作为索引号内容，若按关键字顺序排列，则还可以支持按照关键字折半查找，每当要增加/删除一个记录时，需要对索引表进行修改；由于索引文件有很快的检索速度，因此主要用于对信息处理的及时性要求比较高的场合
##### 索引顺序文件

索引顺序文件是索引文件和顺序文件思想的结合；索引顺序文件中，同样会为文件建立一张索引表，但不同的是:并不是每个记录对应一个索引表项，而是一组记录对应一个索引表项

为了进一步提高检索效率，可以为顺序文件建立多级索引表
***
### 文件的物理结构

文件的物理结构：指文件在外存上的存储组织形式，这不仅和存储介质的存储性能有关，还与所采用的外存分配方式有关

文件的外存分配方法有**连续分配、链接分配**和**索引分配**三种，采用不同的分配方式时，将形成不同的文件物理结构
#### 连续分配

连续分配方式要求每个文件在磁盘上占有一组连续的块

- 特点
优点：支持顺序访问和直接访问(即随机访问)；连续分配的文件在顺序访问时速度最快
缺点：不方便文件拓展;存储空间利用率低，会产生磁盘碎片
#### 链接分配

链接分配采取离散分配的方式，可以为文件分配离散的磁盘块；分为隐式链接和显式链接两种

- 隐式链接
除文件的最后一个盘块之外，每个盘块中都存有指向下一个盘块的指针，文件目录包括文件第一块的指针和最后一块的指针
优点：很方便文件拓展，不会有碎片问题，外存利用率高
缺点：只支持顺序访问，不支持随机访问，查找效率低，指向下一个盘块的指针也需要耗费少量的存储空间

- 显式链接
把用于链接文件各物理块的指针显式地存放在一张表中，即文件分配表(FAT，File Allocation Table)，一个磁盘只会建立一张文件分配表，开机时文件分配表放入内存，并常驻内存
优点：很方便文件拓展，不会有碎片问题，外存利用率高，并且支持随机访问，相比于隐式链接来说，地址转换时不需要访问磁盘，文件的访问效率更高
缺点：文件分配表的需要占用一定的存储空间
#### 索引分配

索引分配允许文件离散地分配在各个磁盘块中，系统会为每个文件建立一张索引表，索引表中记录了文件的各个逻辑块对应的物理块，索引表存放的磁盘块称为索引块，文件数据存放的磁盘块称为数据块

- 链接方案
索引表太大，一个索引块装不下，那么可以将多个索引块链接起来存放；
缺点:若文件很大，索引表很长，就需要将很多个索引块链接起来，必须先依次读入索引块，这就导致磁盘I/O次数过多，查找效率低下

- 多层索引
建立多层索引(原理类似于多级页表)；采用K层索引结构，且顶级索引表未调入内存，则访问一个数据块只需要K+1次读磁盘操作；
缺点：即使是小文件，访问一个数据块依然需要K+1次读磁盘

- 混合索引
多种索引分配方式的结合；例如，一个文件的顶级索引表中，既包含直接地址引(直接指向数据块)，又包含多级间接索引；
优点：对于小文件来说，访问一个数据块所需的读磁盘次数更少

![[Pasted image 20240529225530.png]]
***
连续分配方式对应顺序文件结构，链接分配方式形成链接文件结构，索引分配方式将形成索引文件结构；部分系统如DOS操作系统对三种方法都支持，但是更普遍的是一个系统只提供一种方法的支持

